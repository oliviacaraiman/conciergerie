<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" charset="UTF-8">
        <!--  CSS Files -->
        <link rel="stylesheet"
              href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
              integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
              crossorigin="anonymous" />
        <link rel="stylesheet" href="css/bootstrap.min.css"></link>
        <link rel="stylesheet" href="css/datepicker.css"></link>
        <link rel="stylesheet" href="css/clockpicker.css"></link>
        <link rel="stylesheet" href="css/style.css"></link>
        <!-- JS Files -->
        <script src="//code.jquery.com/jquery-1.12.0.min.js">
        <script
        src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
              crossorigin="anonymous"></script>

        <script
            src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>

        <script src="js/bootstrap-datepicker.js"></script>
        <script src="js/clockpicker.js"></script>


        <link rel="shortcut icon" type="images/png" href="img/favicon.png"/>

        <title>Fil d'actualité</title>
    </head>
    <body>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <a class="navbar-brand" href="filActu.html">
                <img src="img/logo.png" alt="Campus Exchange">
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse"
                    data-target="#navbarColor02" aria-controls="navbarColor02"
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarColor02">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item"><a class="nav-link" href="deposerAnnonce.html">D&eacute;poser
                            une annonce
                        </a></li>
                    <li class="nav-item"><a class="nav-link" href="offres.html">Offres</a></li>
                    <li class="nav-item"><a class="nav-link" href="demandes.html">Demandes</a></li>
                    <li class="nav-item"><a class="nav-link" href="mesAnnonces.html">Mes annonces</a></li>
                    <li class="nav-item"><a class="nav-link" href="mesReponses.html">Mes réponses</a></li>
                </ul>

                <ul class="nav navbar-nav ml-auto">
                    <li class="nav-item dropdown"><a
                            class="nav-link dropdown-toggle" data-toggle="dropdown" href="#"
                            role="button" aria-haspopup="true" aria-expanded="true" id="bonjour"></a>
                        <div class="dropdown-menu" x-placement="bottom-start"
                             style="position: absolute; will-change: transform; top: 0px; left: 0px; transform: translate3d(0px, 37px, 0px);">
                            <a class="dropdown-item" href="profile.html">Paramètres</a> <a
                                class="dropdown-item" href="contact.html">Contact support</a> <a
                                class="dropdown-item" href="#" id="deco">Déconnexion</a>
                        </div></li>
                </ul>
            </div>
        </nav>


        <div class='container'>
            <div  id="popup">
            </div>
            <ul class="nav nav-pills flex-column"  >

                <li class="nav-item dropdown show " style ="width:100%" >
                    <a id="filtres" class="nav-link dropdown-toggle"  data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="true">Filtrer</a>
                    <div  id="menu" class="dropdown-menu" style ="width:100%" x-placement="bottom-start" style="position: absolute; transform: translate3d(0px, 37px, 0px); top: 0px; left: 0px; will-change: transform;">
                        <!-- Type d'annonce  -->
                        <div class="form-inline form-group">
                            &nbsp;
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input"
                                       id="offre" checked="" name="type">
                                <label class="custom-control-label" for="offre">Offre</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input"
                                       id="demande" name="type"> <label
                                       class="custom-control-label" for="demande">Demande</label>
                            </div>
                            <div class="custom-control custom-radio custom-control-inline">
                                <input type="radio" class="custom-control-input"
                                       id="tousTypes" name="type"> <label
                                       class="custom-control-label" for="tousTypes">Tous types</label>
                            </div>
                            <!-- Catégories -->
                            <div class="form-group">

                                <label for="categories"> <select
                                        class="form-control select" id="categories">
                                        <option>Toutes catégories</option>
                                        <option>Bricolage</option>
                                        <option>Education</option>
                                        <option>Electrom&eacute;nager</option>
                                        <option>Informatique</option>
                                        <option>Jeux</option>
                                        <option>Literie</option>
                                        <option>Meubles</option>
                                        <option>T&eacute;l&eacute;phonie</option>
                                        <option>Ustensiles de cuisine</option>
                                        <option>V&ecirc;tements</option>
                                    </select>
                            </div>
                            &nbsp;

                            <!-- Localisations-->
                            <div class="form-group">
                                <select
                                    class="form-control select" id="localisations">
                                    <option>Toutes localisations</option>
                                    <option>R&eacute;sidence A</option>
                                    <option>R&eacute;sidence B</option>
                                    <option>R&eacute;sidence C</option>
                                    <option>R&eacute;sidence D</option>
                                    <option>R&eacute;sidence E</option>
                                    <option>R&eacute;sidence F</option>
                                    <option>R&eacute;sidence G</option>
                                    <option>R&eacute;sidence H</option>
                                    <option>R&eacute;sidence I</option>
                                    <option>R&eacute;sidence J</option>
                                    <option>R&eacute;sidence M</option>
                                    <option>Autre</option>
                                </select>
                            </div>

                        </div>
                        <!-- Objet -->
                        <div class="form-group">

                            <input type="text"
                                   class="form-control" id="objet"
                                   placeholder="Que recherchez-vous ?">
                        </div>

                        <!-- Date de dispo -->
                        <div class="form-group form-inline">
                            &nbsp;
                            <label class="control-label" for="date">Date de
                                disponibilité</label> &nbsp;<input class="form-control" id="date" 
                                                               placeholder="le DD/MM/AAAA" type="text" />&nbsp;<div><input type="text"
                                                                                        class="form-control" id="time" placeholder="à HH:mm"><div class="invalid-feedback">Veuillez renseigner une date ultérieure.</div></div>
                        </div>

                        <!-- Durée de dispo-->
                        <div class="form-inline form-group">
                            &nbsp;
                            <div class="form-group">
                                <label for="objet">Dur&eacute;e de disponibilit&eacute;</label>&nbsp; <input
                                    type="number" class="form-control" id="duree" min="1"
                                    placeholder="Renseignez la dur&eacute;e de disponibilit&eacute; de l'objet">
                            </div>&nbsp;

                            <!-- En minutes, en heures ou en jours-->
                            <div class="form-group ">
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input type="radio" class="custom-control-input"
                                           id="minutes" name="unite" checked="">
                                    <label class="custom-control-label" for="minutes">Minutes</label>
                                </div>
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input type="radio" class="custom-control-input"
                                           id="heures" name="unite">
                                    <label class="custom-control-label" for="heures">Heures</label>
                                </div>
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input type="radio" class="custom-control-input"
                                           id="jours" name="unite"> <label
                                           class="custom-control-label" for="jours">Jours</label>
                                </div>
                            </div>
                        </div>

                        <!-- Nombre de points-->
                        <div class="form-inline form-group" >
                            &nbsp;
                            <div class="form-group">
                                <label for="nbPts">Nombre de points </label>&nbsp; <input type="number"
                                                                                          class="form-control" id="nbPts" min="1"
                                                                                          placeholder="Renseignez le nombre de points par">

                            </div>&nbsp;
                            <div class="form-group ">
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input type="radio" class="custom-control-input"
                                           id="minutesPrix" name="unitePrix" checked="">
                                    <label class="custom-control-label" for="minutesPrix">Minutes</label>
                                </div>
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input type="radio" class="custom-control-input"
                                           id="heuresPrix" name="unitePrix">
                                    <label class="custom-control-label" for="heuresPrix">Heures</label>
                                </div>
                                <div class="custom-control custom-radio custom-control-inline">
                                    <input type="radio" class="custom-control-input"
                                           id="joursPrix" name="unitePrix"> <label
                                           class="custom-control-label" for="joursPrix">Jours</label>
                                </div>
                            </div>
                        </div>
                        <!-- Validation -->
                        <div class="center">
                            <button type="button" class="btn btn-primary" id="filtrer"
                                    >Filtrer</button>
                            <button type="button" class="btn btn-primary" id="annuler"
                                    >Annuler</button>
                        </div>

                    </div>

                </li>

            </ul>
            <br/>
            <div id="fil"></div>
            <!-- Pop Up d'erreur -->
                <div class="modal" id="erreur">
                    <div class="modal-dialog">
                        <div class="modal-content">

                            <div class="modal-header">
                                <h4 class="modal-title">Erreur</h4>
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                            </div>

                            <div class="modal-body">
                                La requête n'a pas pu aboutir. Veuillez réessayer ultérieurement.
                            </div>

                            <div class="modal-footer">
                                <button type="button" id="deposer" class="btn btn-danger" data-dismiss="modal">Fermer</button>
                            </div>

                        </div>
                    </div>
                </div>
           
            
            <!-- Pop Up de confirmation signalisation -->
            <div class="modal" id="validationSignaler">
                    <div class="modal-dialog">
                        <div class="modal-content">

                            <div class="modal-header">
                                <h4 class="modal-title">Confirmation</h4>
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                            </div>

                            <div class="modal-body">
                                L'annonce a bien été signalée.
                            </div>

                            <div class="modal-footer">
                                <button type="button"  class="btn btn-danger" data-dismiss="modal">Fermer</button>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            
            <script>
        
        $(document).ready(function () {
            var session = new Object();
            session.todo = "recupererInfoPersonne";
            $.ajax({
            type: 'POST',
                    url: './ActionServlet',
                    data: session,
                    timeout: 3000,
                    dataType:'json',
                    success: function (data) {
                    console.log(data);
                    if (!data.session){
                    window.location.replace(
                            "./index.html");
            }
            else{
                         document.getElementById("bonjour").innerHTML="Bonjour, "+ data.prenom;
                         document.getElementById("deco").addEventListener("click", function () {
                        var deco=new Object();
                        deco.todo="seDeconnecter";
                    $.ajax({
                    type: 'POST',
                            url: './ActionServlet',
                            data: deco,
                            timeout: 3000,
                            dataType:'json',
                            success: function (data) {
                            console.log(data);
                            if (data.deconnexion){
                            window.location.replace(
                                    "./index.html");
            }
            else{

                                    $("#erreur").modal();
                    }
                    },
                    error: function (data) {
                    console.log(data);
                                    $("#erreur").modal();
                }
                });
                });
                            if (window.location.href.indexOf('annonce') > - 1){
                    $('#popup').append(' <div class="alert alert-dismissible alert-primary" ><button type="button" class="close" data-dismiss="alert">&times;</button> <a class="alert-link">Votre annonce a bien été publiée.</div>');
        }
        
        if (window.location.href.indexOf('reponse') > - 1){
                    $('#popup').append(' <div class="alert alert-dismissible alert-primary"><button type="button" class="close" data-dismiss="alert">&times;</button> <a class="alert-link">Votre réponse a bien été transmise.</div>');
        }
        
        
        $('#date').datepicker({
                            format: "dd/mm/yyyy",
                            locale: "fr",
                            autoclose: true,
                            todayHighlight: true,
                            pick12HourFormat: true
            });
            
            
            $('#time').clockpicker({
                            autoclose: true,
                            donetext: 'Done'
                    });
                    
                    $('#filtres').click(function (e) {
                            if ($("#menu").is(":visible") && e.target.attributes[0].nodeValue == "filtres") {
                    $('#menu').hide()
                    } else {
                            e.stopPropagation()
                            $('#menu').show()
                            }
                        
                        })
                    
                    $('#annuler').click(function (e) {
                            $('#menu').hide()
                    })
                    
                    $('#filtrer').click(function(e){
                            var filtres = new Object();
                    var send = true;
                    filtres.todo = "afficherFilActualite";
                    //Type
                    filtres.type = "demande";
                    if ($('#offre').is(':checked')) {
                    filtres.type = "offre";
                        }
                        if ($('#tousTypes').is(':checked')) {
                    filtres.type = "";
                        }
                        //Catégorie
                        filtres.categorie = document.getElementById('categories').value;
                        if(filtres.categorie=="Toutes catégories"){
                            filtres.categorie="";
                        }
                             //Nom objet
                             filtres.objet = document.getElementById("objet").value;
                            
                                filtres.date = document.getElementById("date").value;
                                filtres.time = document.getElementById("time").value;
                                //Date
                        if (document.getElementById("date").value != "" && document.getElementById("time").value != "") {
                            var wanted = new Date(filtres.date.split('/')[2], filtres.date.split('/')[1] - 1, filtres.date.split('/')[0], filtres.time.split(':')[0], filtres.time.split(':')[1]);
                    if (Date.now() <= wanted.getTime()){
                    document.getElementById("date").classList.remove("is-invalid");
                    document.getElementById("time").classList.remove("is-invalid");
                    }
                    else{
                            send = false;
                    document.getElementById("date").classList.add("is-invalid");
                    document.getElementById("time").classList.add("is-invalid");
                            }
                            
                            
                            } else if(document.getElementById("date").value == "" && document.getElementById("time").value != ""){
                            send = false;
                    document.getElementById("date").classList.add("is-invalid");
                            }
                            else if(document.getElementById("date").value != "" && document.getElementById("time").value == ""){
                            var wanted = new Date(filtres.date.split('/')[2], filtres.date.split('/')[1] - 1, filtres.date.split('/')[0], 0, 0);
                    if (Date.now() <= wanted.getTime()){
                    document.getElementById("date").classList.remove("is-invalid");
                    document.getElementById("time").classList.remove("is-invalid");
                                }
                                else{
                            send = false;
                    document.getElementById("date").classList.add("is-invalid");
                                        }
                                        }
                                        
                                        //Heure
                                        filtres.time = document.getElementById("time").value;
                                        
                                        //Durée
                                        filtres.duree = document.getElementById("duree").value;
                                        
                                        //Unité durée
                                        filtres.uniteDuree = "heures";
                                        if ($('#jours').is(':checked')) {
                            filtres.uniteDuree = "jours";
                            } else if ($('#minutes').is(':checked')) {
                            filtres.uniteDuree = "minutes";
                            }
                            //Localisation
                                filtres.localisation = document.getElementById('localisations').value;
                                if(filtres.localisation=="Toutes localisations"){
                                    filtres.localisation="";
                                }
                                    
                                    //nbPts
                                    filtres.nbPts = document.getElementById("nbPts").value;
                                    
                                    //Unité prix
                                    filtres.unitePrix = "heures";
                                    if ($('#joursPrix').is(':checked')) {
                            filtres.unitePrix = "jours";
                                    } else if ($('#minutesPrix').is(':checked')) {
                            filtres.unitePrix = "minutes";
                                    }
                                    console.log(filtres);
                                    if(send){
                            $('#menu').hide()
                            $.ajax({
                            type: 'GET',
                                    url: './ActionServlet',
                                    data: filtres,
                                    timeout: 3000,
                                    dataType:'json',
                                    success: function (data) {
                                     $('#fil').empty();
                                     if(data.Annonces.length==0){
                                         $('#fil').append('<p>Aucune annonce ne correspond à votre recherche</p>')
                                     }
                                    for (var i in data.Annonces)
                                    {
                                    var annonce = '<div class="card mb-3"><h3 class="card-header">';
                            if (data.Annonces[i].typeAnnonce == "offre"){
                            annonce += '<span style="color:#007bff" >OFFRE</span>';
                            }
                            else if (data.Annonces[i].typeAnnonce == "demande"){
                            annonce += '<span style="color:#f47d42" >DEMANDE</span>';
                            }

                           annonce += ' - Prêt - ' + data.Annonces[i].nomObjet;
                            if(!data.Annonces[i].memePersonne){
                                annonce +='<div class="text-right">\n\
                                                           <button type="button" class="btn btn-outline-warning" onclick="window.location.href =';
                                if (data.Annonces[i].typeAnnonce == "offre"){
                                annonce += "'./repondreOffre.html?idAnnonce="+data.Annonces[i].idAnnonce +"'"+'"'+'">Répondre</button></div>';
                                }
                                else if (data.Annonces[i].typeAnnonce == "demande"){
                                annonce += "'./repondreDemande.html?idAnnonce="+data.Annonces[i].idAnnonce +"'"+'"'+'">Répondre</button></div>';
                                }
            
                            }
                            
                            annonce += '</h3><div class="card-body"><h6 class="card-subtitle text-muted">' + data.Annonces[i].categorie + '</h6>';
                            if (data.Annonces[i].images != undefined && data.Annonces[i].images.length != 0){
                            annonce += '<div id="carousel' + i + '" class="carousel slide" data-ride="carousel">\n\
                                        <div class="carousel-inner">\n\
                                        <div class="carousel-item active">\n\
                                    <img class="d-block w-100 center"  style="max-width:50%;max-height:20%" src="' + data.Annonces[i].images[0] + '" alt="First slide"></div>';
                            for (var j = 1; j < data.Annonces[i].images.length; j++){
                            annonce += '<div class="carousel-item">\n\
                                                   <img class="d-block w-100 center" style="max-width:50%;max-height:20%" src="' + data.Annonces[i].images[j] + '" alt="Second slide">\n\
                                                   </div>';
                            }
                            
                            annonce += '</div>\n\
                            <a class="carousel-control-prev" href="#carousel' + i + '" role="button" data-slide="prev">\n\
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>\n\
                                <span class="sr-only">Previous</span>\n\
                            </a>\n\
                            <a class="carousel-control-next" href="#carousel' + i + '" role="button" data-slide="next">\n\
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>\n\
                            <span class="sr-only">Next</span>\n\
                            </a>\n\
                            </div>';
                            }
                            else{
                                annonce += '<img class="d-block w-100 center" style="max-width:50%;max-height:20%" src="http://cliquecities.com/assets/no-image-e3699ae23f866f6cbdf8ba2443ee5c4e.jpg" >';
                            }
                            annonce += '<div><div class="card"><div class="card-header">\n\
                <h5 class="mb-0">\n\
                    <button class="btn btn-link" data-toggle="collapse" data-target="#collapse' + i + '" aria-expanded="true" aria-controls="collapse' + i + '" id="accordion' + i + '">\n\
                Détails\n\
                </button>\n\
                    </h5>\n\
                        </div>\n\
                        <div id="collapse' + i + '" class="collapse" aria-labelledby="headingOne" data-parent="#accordion' + i + '">';
                            if (data.Annonces[i].description != undefined && data.Annonces[i].description != "" ){
                            annonce += '<div class="card-body">' + data.Annonces[i].description + '</div>';
                            }
                            var noteAuteur;
                            if(data.Annonces[i].noteMoyenneAuteur != -1){noteAuteur = data.Annonces[i].noteMoyenneAuteur }else{noteAuteur='Non noté'}
                    
                            annonce += '<ul class="list-group list-group-flush"><li class="list-group-item">Date de disponibilité : ' + data.Annonces[i].date + ' ' + data.Annonces[i].time + '</li>\n\
                                <li class="list-group-item">Durée de disponibilité : ' + data.Annonces[i].duree + ' ' + data.Annonces[i].uniteDuree + '</li>\n\
                            <li class="list-group-item">Prix : ' + data.Annonces[i].nbPts + ' points par ' + data.Annonces[i].unitePrix + '</li>\n\
                                <li class="list-group-item">Localisation : ' + data.Annonces[i].localisation + '</li>\n\
                                </ul></div></div><div class="card-footer text-muted">Contact : '+data.Annonces[i].auteur +'<br/>Note : '+noteAuteur+'<br/>Le ' + data.Annonces[i].datePublication + ' à ' + data.Annonces[i].timePublication + '</div></div></div>'
                                    $('#fil').append(annonce);
                                    }
                                    },
                                            error: function (data) {
                                            console.log(data);
                                            $("#erreur").modal();
                                            }
                                    });
                            }

                            })

                            var filtres = new Object();
                    filtres.todo = "afficherFilActualite";
                    //Type
                    filtres.type = "";
                    //Catégorie
                    filtres.categorie = "";
                    //Nom objet
                    filtres.objet = "";
                    //Date
                    filtres.date = "";
                    //Heure
                    filtres.time = "";
                    //Durée
                    filtres.duree = "";
                    //Unité durée
                    filtres.uniteDuree = "";
                    //Localisation
                    filtres.localisation = "";
                    //nbPts
                    filtres.nbPts = "";
                    //Unité prix
                    filtres.unitePrix = "";
                    console.log(filtres);
                    $.ajax({
                    type: 'GET',
                            url: './ActionServlet',
                            data: filtres,
//                                timeout: 3000,
                            dataType:'json',
                            success: function (data) {
                            console.log(data);
                            $('#fil').empty();
                            if(data.Annonces.length==0){
                                         $('#fil').append('<p>Aucune annonce ne correspond à votre recherche</p>')
                                     }
                            for (var i in data.Annonces)
                            {
                            var annonce = '<div class="card mb-3"><h3 class="card-header">';
                            if (data.Annonces[i].typeAnnonce == "offre"){
                            annonce += '<span style="color:#007bff" >OFFRE</span>';
                            }
                            else if (data.Annonces[i].typeAnnonce == "demande"){
                            annonce += '<span style="color:#f47d42" >DEMANDE</span>';
                            }

                            annonce += ' - Prêt - ' + data.Annonces[i].nomObjet;
                            if(!data.Annonces[i].memePersonne){
                                annonce +='<div class="text-right">\n\
                                                           <button type="button" class="btn btn-outline-warning" onclick="window.location.href =';
                                if (data.Annonces[i].typeAnnonce == "offre"){
                                annonce += "'./repondreOffre.html?idAnnonce="+data.Annonces[i].idAnnonce +"'"+'"'+'">Répondre</button></div>';
                                }
                                else if (data.Annonces[i].typeAnnonce == "demande"){
                                annonce += "'./repondreDemande.html?idAnnonce="+data.Annonces[i].idAnnonce +"'"+'"'+'">Répondre</button></div>';
                                }
            
                            }
                            
                            annonce += '</h3><div class="card-body"><h6 class="card-subtitle text-muted">' + data.Annonces[i].categorie + '</h6>';
                            if (data.Annonces[i].images != undefined && data.Annonces[i].images.length != 0){
                            annonce += '<div id="carousel' + i + '" class="carousel slide" data-ride="carousel">\n\
                                        <div class="carousel-inner">\n\
                                        <div class="carousel-item active">\n\
                                    <img class="d-block w-100 center"  style="max-width:50%;max-height:20%" src="' + data.Annonces[i].images[0] + '" alt="First slide"></div>';
                            for (var j = 1; j < data.Annonces[i].images.length; j++){
                            annonce += '<div class="carousel-item">\n\
                                                   <img class="d-block w-100 center" style="max-width:50%;max-height:20%" src="' + data.Annonces[i].images[j] + '" alt="Second slide">\n\
                                                   </div>';
                            }
                            
                            annonce += '</div>\n\
                            <a class="carousel-control-prev" href="#carousel' + i + '" role="button" data-slide="prev">\n\
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>\n\
                                <span class="sr-only">Previous</span>\n\
                            </a>\n\
                            <a class="carousel-control-next" href="#carousel' + i + '" role="button" data-slide="next">\n\
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>\n\
                            <span class="sr-only">Next</span>\n\
                            </a>\n\
                            </div>';
                            }
                            else{
                                annonce += '<img class="d-block w-100 center" style="max-width:50%;max-height:20%" src="http://cliquecities.com/assets/no-image-e3699ae23f866f6cbdf8ba2443ee5c4e.jpg" >';
                            }
                            annonce += '<div><div class="card"><div class="card-header">\n\
                <h5 class="mb-0">\n\
                    <button class="btn btn-link" data-toggle="collapse" data-target="#collapse' + i + '" aria-expanded="true" aria-controls="collapse' + i + '" id="accordion' + i + '">\n\
                Détails\n\
                </button>\n\
                    </h5>\n\
                        </div>\n\
                        <div id="collapse' + i + '" class="collapse" aria-labelledby="headingOne" data-parent="#accordion' + i + '">';
                            if (data.Annonces[i].description != undefined && data.Annonces[i].description != ""){
                            annonce += '<div class="card-body">' + data.Annonces[i].description + '</div>';
                            }
                            var noteAuteur;
                            if(data.Annonces[i].noteMoyenneAuteur != -1){noteAuteur = data.Annonces[i].noteMoyenneAuteur }else{noteAuteur='Non noté'}
                    
                            annonce += '<ul class="list-group list-group-flush"><li class="list-group-item">Date de disponibilité : ' + data.Annonces[i].date + ' ' + data.Annonces[i].time + '</li>\n\
                                <li class="list-group-item">Durée de disponibilité : ' + data.Annonces[i].duree + ' ' + data.Annonces[i].uniteDuree + '</li>\n\
                            <li class="list-group-item">Prix : ' + data.Annonces[i].nbPts + ' points par ' + data.Annonces[i].unitePrix + '</li>\n\
                                <li class="list-group-item">Localisation : ' + data.Annonces[i].localisation + '</li>\n\
                                </ul></div></div><div class="card-footer text-muted">Contact : '+data.Annonces[i].auteur +'<br/>Note : '+noteAuteur+'<br/>Le ' + data.Annonces[i].datePublication + ' à ' + data.Annonces[i].timePublication + '<div class="text-right"><a onclick="$.ajax({\n\
                            type:'+" 'POST',\n\
                                    url: './ActionServlet',\n\
                                    data: {todo : 'signalerAnnonce', idAnnonce : "+ data.Annonces[i].idAnnonce +" },\n\
                                    timeout: 3000,\n\
                                    dataType:'json',\n\
                                    success: function (data) {\n\
                                    console.log(data);\n\
                                    if (data.signale){"+'\n\
                                        document.getElementById('+"'validationSignaler'"+').show();\n\
                                    }\n\
                                    else{\n\
                                            document.getElementById('+"'erreur'"+').show();\n\
                            }\n\
                            },\n\
                    error: function () {\n\
                                            document.getElementById('+"'erreur'"+').show();\n\
                    }\n\
                    });"  > Signaler</a></div></div></div></div>';
                                    $('#fil').append(annonce);
                            }
                            },
                            error: function (data) {
                            console.log(data);
                            $("#erreur").modal();
                            }
                    });
                    }
                    },
                            error: function (data) {
                                console.log(data);
                            $("#erreurReseau").modal();
                            }
                    });
                    
                    
                    
                    
                    });
                    
        </script>


    </body>
</html>
